<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://xavier2code.site name=base><title>
            
                Ownership in Rust
            
        </title><meta content="Ownership in Rust" property=og:title><link href=https://xavier2code.site/favicon.png rel=icon type=image/png><link href=https://xavier2code.site/fonts.css rel=stylesheet><script async data-goatcounter=https://xavier2code.goatcounter.com/count src=https://xavier2code.site/js/count.js></script><noscript><img src="https://xavier2code.goatcounter.com//count?p=/posts/rust1/&t=Ownership in Rust"></noscript><script defer src=https://xavier2code.site/js/codeblock.js></script><script src=https://xavier2code.site/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link href=https://xavier2code.site/atom.xml rel=alternate title=xavier2code type=application/atom+xml><link href=https://xavier2code.site/theme/light.css rel=stylesheet><link href=https://xavier2code.site/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://xavier2code.site/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://xavier2code.site/main.css media=screen rel=stylesheet><script src="https://xavier2code.site/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=left-content></div><div class=content><nav><div class=left-nav><a href=https://xavier2code.site>xavier2code</a><div class=socials><a class=social href=https://mail.google.com/ rel=me> <img alt=email src=https://xavier2code.site/icons/social/email.svg> </a><a class=social href=https://github.com/xavier2code/ rel=me> <img alt=github src=https://xavier2code.site/icons/social/github.svg> </a><a class=social href=https://discord.com/ rel=me> <img alt=discord src=https://xavier2code.site/icons/social/discord.svg> </a><a class=social href=https://www.reddit.com/ rel=me> <img alt=reddit src=https://xavier2code.site/icons/social/reddit.svg> </a><a class=social href=https://x.com/ rel=me> <img alt=x-twitter src=https://xavier2code.site/icons/social/x-twitter.svg> </a></div></div><div class=right-nav><a href=https://xavier2code.site/posts style=margin-right:.5em>/posts</a><a href=https://xavier2code.site/projects style=margin-right:.5em>/projects</a><a href=https://xavier2code.site/archive style=margin-right:.5em>/archive</a><a href=https://xavier2code.site/about style=margin-right:.5em>/about</a><a href=https://xavier2code.site/tags style=margin-right:.5em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://xavier2code.site/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://xavier2code.site/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://xavier2code.site/icons/moon.svg> </a><script>updateItemToggleTheme()</script></div></nav><div data-selector="main article p" class=visible-element-observer-root><main><article><div class=title><div class=page-header>Ownership in Rust</div><div class=meta>Posted on <time>2025-02-05</time><span class=tags-label> :: </span><span class=tags> <a class=post-tag href=https://xavier2code.site/tags/documentation/>documentation</a> <a class=post-tag href=https://xavier2code.site/tags/rust/>rust</a> </span></div></div><section class=body><h2 id=the-concept-of-ownership><a aria-label="Anchor link for: the-concept-of-ownership" class=zola-anchor href=#the-concept-of-ownership>The Concept of Ownership</a></h2><p>In Rust, ownership is a set of rules that govern how memory is managed in a program. Unlike languages that use garbage collection (e.g., Java or Python), Rust manages memory through a system of ownership with a set of rules that the compiler checks at compile time. These rules ensure that memory is always valid and that there are no data races or undefined behavior. The ownership system in Rust is based on three core rules: Each value in Rust has a single owner. At any given time, only one variable can own a value. When the owner goes out of scope, the value is dropped. When the owner variable goes out of scope, the value is automatically deallocated. Ownership can be transferred between variables. Ownership can be moved from one variable to another, but only one variable can own the value at a time.<h2 id=the-importance-of-ownership><a aria-label="Anchor link for: the-importance-of-ownership" class=zola-anchor href=#the-importance-of-ownership>The Importance of Ownership</a></h2><p>Ownership is a fundamental concept in Rust that ensures memory safety without the need for a garbage collector. It helps prevent common bugs such as null pointer dereferencing, data races, and memory leaks. By enforcing these rules at compile time, Rust provides strong guarantees about the safety and correctness of code.<h2 id=applications-of-ownership><a aria-label="Anchor link for: applications-of-ownership" class=zola-anchor href=#applications-of-ownership>Applications of Ownership</a></h2><h3 id=ownership-and-variables><a aria-label="Anchor link for: ownership-and-variables" class=zola-anchor href=#ownership-and-variables>Ownership and Variables</a></h3><p>When a variable is assigned a value, it becomes the owner of that value. When the variable goes out of scope, the value is dropped.<p>Example:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>fn </span><span style=color:#f29718>main</span><span>() {
</span><span>    </span><span style=color:#fa6e32>let</span><span> s1 </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>String</span><span style=color:#ed9366>::</span><span>from(</span><span style=color:#86b300>"hello"</span><span>)</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// s1 owns the String value
</span><span>    {
</span><span>        </span><span style=color:#fa6e32>let</span><span> s2 </span><span style=color:#ed9366>=</span><span> s1</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// s2 now owns the String value, s1 is no longer valid
</span><span>        </span><span style=color:#f07171>println!</span><span>(</span><span style=color:#86b300>"</span><span style=color:#ff8f40>{}</span><span style=color:#86b300>"</span><span style=color:#61676ccc>,</span><span> s2)</span><span style=color:#61676ccc>;
</span><span>    } </span><span style=color:#abb0b6;font-style:italic>// s2 goes out of scope, the String value is dropped
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// println!("{}", s1); // This would cause a compile-time error because s1 no longer owns the value
</span><span>}
</span></code></pre><p>In this example, s1 initially owns the String value. When s2 is assigned the value of s1, ownership is transferred to s2, and s1 is no longer valid. When s2 goes out of scope, the String value is dropped.<h3 id=ownership-and-functions><a aria-label="Anchor link for: ownership-and-functions" class=zola-anchor href=#ownership-and-functions>Ownership and Functions</a></h3><p>When a value is passed to a function, ownership is transferred to the function parameter. When the function returns, ownership is transferred back to the caller.<p>Example:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>fn </span><span style=color:#f29718>take_ownership</span><span>(</span><span style=color:#ff8f40>s</span><span style=color:#61676ccc>:</span><span> String) {
</span><span>    </span><span style=color:#f07171>println!</span><span>(</span><span style=color:#86b300>"</span><span style=color:#ff8f40>{}</span><span style=color:#86b300>"</span><span style=color:#61676ccc>,</span><span> s)</span><span style=color:#61676ccc>;
</span><span>} </span><span style=color:#abb0b6;font-style:italic>// s is dropped here
</span><span>
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>main</span><span>() {
</span><span>    </span><span style=color:#fa6e32>let</span><span> s </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>String</span><span style=color:#ed9366>::</span><span>from(</span><span style=color:#86b300>"hello"</span><span>)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#f07171>take_ownership</span><span>(s)</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// Ownership of s is transferred to the function
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// println!("{}", s); // This would cause a compile-time error because s no longer owns the value
</span><span>}
</span></code></pre><p>In this example, when s is passed to take_ownership, ownership is transferred to the function parameter s. When the function ends, s is dropped, and the original variable s in main is no longer valid.<h3 id=borrowing-and-references><a aria-label="Anchor link for: borrowing-and-references" class=zola-anchor href=#borrowing-and-references>Borrowing and References</a></h3><p>Rust also allows borrowing values through references, which do not take ownership. References can be either mutable or immutable. Immutable references (&T) allow multiple references to the same data, but the data cannot be modified. Mutable references (&mut T) allow a single reference to modify the data, but no other references can exist at the same time.<p>Example:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>fn </span><span style=color:#f29718>main</span><span>() {
</span><span>    </span><span style=color:#fa6e32>let</span><span> s1 </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>String</span><span style=color:#ed9366>::</span><span>from(</span><span style=color:#86b300>"hello"</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#fa6e32>let</span><span> len </span><span style=color:#ed9366>= </span><span style=color:#f07171>calculate_length</span><span>(</span><span style=color:#ed9366>&</span><span>s1)</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// Immutable borrow
</span><span>    </span><span style=color:#f07171>println!</span><span>(</span><span style=color:#86b300>"The length of '</span><span style=color:#ff8f40>{}</span><span style=color:#86b300>' is </span><span style=color:#ff8f40>{}</span><span style=color:#86b300>."</span><span style=color:#61676ccc>,</span><span> s1</span><span style=color:#61676ccc>,</span><span> len)</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#fa6e32>let mut</span><span> s2 </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>String</span><span style=color:#ed9366>::</span><span>from(</span><span style=color:#86b300>"hello"</span><span>)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#f07171>change</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> s2)</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// Mutable borrow
</span><span>    </span><span style=color:#f07171>println!</span><span>(</span><span style=color:#86b300>"</span><span style=color:#ff8f40>{}</span><span style=color:#86b300>"</span><span style=color:#61676ccc>,</span><span> s2)</span><span style=color:#61676ccc>;
</span><span>}
</span><span>
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>calculate_length</span><span>(</span><span style=color:#ff8f40>s</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span>String) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>usize </span><span>{ </span><span style=color:#abb0b6;font-style:italic>// s is an immutable reference
</span><span>    s</span><span style=color:#ed9366>.</span><span style=color:#f07171>len</span><span>()
</span><span>} </span><span style=color:#abb0b6;font-style:italic>// s goes out of scope here, but it doesn't drop the String value
</span><span>
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>change</span><span>(</span><span style=color:#ff8f40>s</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> String) { </span><span style=color:#abb0b6;font-style:italic>// s is a mutable reference
</span><span>    s</span><span style=color:#ed9366>.</span><span style=color:#f07171>push_str</span><span>(</span><span style=color:#86b300>", world"</span><span>)</span><span style=color:#61676ccc>;
</span><span>} </span><span style=color:#abb0b6;font-style:italic>// s goes out of scope here, but it doesn't drop the String value
</span></code></pre><p>In this example, calculate_length takes an immutable reference to s1, allowing it to read the length without taking ownership. change takes a mutable reference to s2, allowing it to modify the String value without taking ownership.<h3 id=ownership-and-structs><a aria-label="Anchor link for: ownership-and-structs" class=zola-anchor href=#ownership-and-structs>Ownership and Structs</a></h3><p>Structs can own data, and when a struct is dropped, all of its owned data is also dropped.<p>Example:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>struct </span><span style=color:#399ee6>User </span><span>{
</span><span>    username</span><span style=color:#61676ccc>:</span><span> String,
</span><span>    email</span><span style=color:#61676ccc>:</span><span> String,
</span><span>    sign_in_count</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>u64</span><span>,
</span><span>}
</span><span>
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>main</span><span>() {
</span><span>    </span><span style=color:#fa6e32>let</span><span> user1 </span><span style=color:#ed9366>=</span><span> User {
</span><span>        email</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>String</span><span style=color:#ed9366>::</span><span>from(</span><span style=color:#86b300>"someone@example.com"</span><span>)</span><span style=color:#61676ccc>,
</span><span>        username</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>String</span><span style=color:#ed9366>::</span><span>from(</span><span style=color:#86b300>"someusername123"</span><span>)</span><span style=color:#61676ccc>,
</span><span>        sign_in_count</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>1</span><span style=color:#61676ccc>,
</span><span>    }</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#fa6e32>let</span><span> user2 </span><span style=color:#ed9366>=</span><span> user1</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// Ownership of user1's fields is transferred to user2
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// println!("{}", user1.email); // This would cause a compile-time error because user1 no longer owns its fields
</span><span>}
</span></code></pre><p>In this example, user1 owns the String values for email and username. When user2 is assigned the value of user1, ownership of these fields is transferred to user2, and user1 is no longer valid.<h3 id=ownership-and-enums><a aria-label="Anchor link for: ownership-and-enums" class=zola-anchor href=#ownership-and-enums>Ownership and Enums</a></h3><p>Enums can also own data, and when an enum is dropped, all of its owned data is also dropped.<p>Example:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>enum </span><span style=color:#399ee6>IpAddr </span><span>{
</span><span>    </span><span style=color:#ff8f40>V4</span><span>(</span><span style=color:#55b4d4;font-style:italic>String</span><span>)</span><span style=color:#61676ccc>,
</span><span>    </span><span style=color:#ff8f40>V6</span><span>(</span><span style=color:#55b4d4;font-style:italic>String</span><span>)</span><span style=color:#61676ccc>,
</span><span>}
</span><span>
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>main</span><span>() {
</span><span>    </span><span style=color:#fa6e32>let</span><span> home </span><span style=color:#ed9366>= </span><span>IpAddr</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>V4</span><span>(</span><span style=color:#55b4d4;font-style:italic>String</span><span style=color:#ed9366>::</span><span>from(</span><span style=color:#86b300>"127.0.0.1"</span><span>))</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#fa6e32>let</span><span> loopback </span><span style=color:#ed9366>=</span><span> home</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// Ownership of home's data is transferred to loopback
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// println!("{:?}", home); // This would cause a compile-time error because home no longer owns its data
</span><span>}
</span></code></pre><p>In this example, home owns the String value for the V4 variant. When loopback is assigned the value of home, ownership of the String value is transferred to loopback, and home is no longer valid.<h2 id=summary><a aria-label="Anchor link for: summary" class=zola-anchor href=#summary>Summary</a></h2><p>Ownership is a fundamental concept in Rust that ensures memory safety and prevents common bugs such as null pointer dereferencing and data races. By managing memory through a set of ownership rules, Rust provides strong guarantees about the safety and correctness of code. Understanding ownership is crucial for writing idiomatic and safe Rust programs.</section></article></main></div><div class=giscus></div><script async crossorigin issue-term=pathname label=Comment repo=xavier2code/blog src=https://utteranc.es/client.js theme=preferred-color-scheme></script></div><div class=right-content></div>