name: Deploy on Push

on:
  push:
    branches:
      - main  # 只在 main 分支 push 时触发

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      # 检出代码
      - name: Checkout code
        uses: actions/checkout@v3

      # 安装 sshpass
      - name: Install sshpass
        run: |
          sudo apt-get update
          sudo apt-get install -y sshpass

      # 通过用户名和密码登录服务器并执行 git pull
      - name: Deploy via SSH
        env:
          SERVER_USER: ${{ secrets.SERVER_USERNAME }}
          SERVER_PASS: ${{ secrets.SERVER_PASSWORD }}
          SERVER_IP: ${{ secrets.SERVER_IP }}
          REPO_PATH: /home/lighthouse/blog
        run: |
          echo $SERVER_IP
